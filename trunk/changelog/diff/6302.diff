Index: modules/integration/console/pom.xml
===================================================================
--- modules/integration/console/pom.xml	(revision 6301)
+++ modules/integration/console/pom.xml	(revision 6302)
@@ -1,61 +1,59 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
-    <modelVersion>4.0.0</modelVersion>
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+  <modelVersion>4.0.0</modelVersion>
 
-    <name>jBPM 4 - Integration Console</name>
-    <description>JBoss jBPM - GWT console integration</description>
+  <name>jBPM 4 - Integration Console</name>
+  <description>JBoss jBPM - GWT console integration</description>
 
+  <groupId>org.jbpm.jbpm4</groupId>
+  <artifactId>jbpm-console-integration</artifactId>
+  <packaging>jar</packaging>
+
+  <parent>
     <groupId>org.jbpm.jbpm4</groupId>
-    <artifactId>jbpm-console-integration</artifactId>
-    <packaging>jar</packaging>
+    <artifactId>jbpm-integration</artifactId>
+    <version>4.4-SNAPSHOT</version>
+  </parent>
 
-    <parent>
-        <groupId>org.jbpm.jbpm4</groupId>
-        <artifactId>jbpm-integration</artifactId>
-        <version>4.4-SNAPSHOT</version>
-    </parent>
+  <!-- Properties -->
+  <properties>
+    <javax.jaxb.version>2.1</javax.jaxb.version>
+  </properties>
 
-    <!-- Properties -->
-    <properties>
-        <javax.jaxb.version>2.1</javax.jaxb.version>
+  <!-- Dependencies -->
+  <dependencies>
+    <dependency>
+      <groupId>org.jbpm.jbpm4</groupId>
+      <artifactId>jbpm-api</artifactId>
+      <version>${project.version}</version>
+      <scope>provided</scope>
+    </dependency>
+    <dependency>
+      <groupId>org.jbpm.jbpm4</groupId>
+      <artifactId>jbpm-pvm</artifactId>
+      <version>${project.version}</version>
+      <scope>provided</scope>
+    </dependency>
+    <dependency>
+      <groupId>org.jboss.bpm</groupId>
+      <artifactId>gwt-console-server-integration</artifactId>
+      <scope>provided</scope>
+    </dependency>
+    <dependency>
+      <groupId>javax.xml.bind</groupId>
+      <artifactId>jaxb-api</artifactId>
+      <version>${javax.jaxb.version}</version>
+      <scope>provided</scope>
+    </dependency>
 
-    </properties>
-
-    <!-- Dependencies -->
-    <dependencies>
-        <dependency>
-            <groupId>org.jbpm.jbpm4</groupId>
-            <artifactId>jbpm-api</artifactId>
-            <version>${project.version}</version>
-            <scope>provided</scope>
-        </dependency>
-        <dependency>
-            <groupId>org.jbpm.jbpm4</groupId>
-            <artifactId>jbpm-pvm</artifactId>
-            <version>${project.version}</version>
-            <scope>provided</scope>
-        </dependency>
-        <dependency>
-            <groupId>org.jboss.bpm</groupId>
-            <artifactId>gwt-console-server-integration</artifactId>
-            <scope>provided</scope>
-        </dependency>
-        <dependency>
-            <groupId>javax.xml.bind</groupId>
-            <artifactId>jaxb-api</artifactId>
-            <version>${javax.jaxb.version}</version>
-            <scope>provided</scope>
-        </dependency>
-
-        <dependency>
-            <groupId>org.jboss.errai</groupId>
-            <artifactId>errai-common</artifactId>
-        </dependency>
-        <dependency>
-            <groupId>org.jboss.errai</groupId>
-            <artifactId>errai-bus</artifactId>
-        </dependency>
-
-    </dependencies>
-
+    <dependency>
+      <groupId>org.jboss.errai</groupId>
+      <artifactId>errai-common</artifactId>
+    </dependency>
+    <dependency>
+      <groupId>org.jboss.errai</groupId>
+      <artifactId>errai-bus</artifactId>
+    </dependency>
+  </dependencies>
 </project>
Index: modules/integration/.project
===================================================================
--- modules/integration/.project	(revision 0)
+++ modules/integration/.project	(revision 6302)
@@ -0,0 +1,17 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<projectDescription>
+	<name>jbpm-integration</name>
+	<comment></comment>
+	<projects>
+	</projects>
+	<buildSpec>
+		<buildCommand>
+			<name>org.maven.ide.eclipse.maven2Builder</name>
+			<arguments>
+			</arguments>
+		</buildCommand>
+	</buildSpec>
+	<natures>
+		<nature>org.maven.ide.eclipse.maven2Nature</nature>
+	</natures>
+</projectDescription>
Index: modules/integration/tomcat/pom.xml
===================================================================
--- modules/integration/tomcat/pom.xml	(revision 6301)
+++ modules/integration/tomcat/pom.xml	(revision 6302)
@@ -1,5 +1,6 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
   <modelVersion>4.0.0</modelVersion>
 
   <name>jBPM 4 - Integration Tomcat 6</name>
@@ -15,10 +16,6 @@
     <version>4.4-SNAPSHOT</version>
   </parent>
 
-  <!-- Properties -->
-  <properties>
-  </properties>
-
   <!-- Dependencies -->
   <dependencies>
     <dependency>
@@ -28,5 +25,4 @@
       <scope>provided</scope>
     </dependency>
   </dependencies>
-
 </project>
Index: modules/integration/pom.xml
===================================================================
--- modules/integration/pom.xml	(revision 6301)
+++ modules/integration/pom.xml	(revision 6302)
@@ -1,5 +1,6 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
   <modelVersion>4.0.0</modelVersion>
 
   <name>jBPM 4 - Integration</name>
@@ -30,11 +31,10 @@
   <!-- Dependecy Management -->
   <dependencyManagement>
     <dependencies>
-
       <dependency>
         <groupId>org.jbpm.jbpm4</groupId>
         <artifactId>jbpm-jpdl</artifactId>
-        <version>${version}</version>
+        <version>${project.version}</version>
       </dependency>
       <dependency>
         <groupId>junit</groupId>
@@ -112,7 +112,6 @@
         <artifactId>slf4j-log4j12</artifactId>
         <version>${slf4j.version}</version>
       </dependency>
-
     </dependencies>
   </dependencyManagement>
 
@@ -123,5 +122,4 @@
     <module>report</module>
     <module>tomcat</module>
   </modules>
-
 </project>
Index: modules/integration/report/pom.xml
===================================================================
--- modules/integration/report/pom.xml	(revision 6301)
+++ modules/integration/report/pom.xml	(revision 6302)
@@ -1,5 +1,6 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
   <modelVersion>4.0.0</modelVersion>
 
   <name>jBPM 4 - Integration Reports</name>
@@ -14,10 +15,4 @@
     <artifactId>jbpm-integration</artifactId>
     <version>4.4-SNAPSHOT</version>
   </parent>
-
-  <!-- Dependencies -->
-  <dependencies>
-    
-  </dependencies>
-
 </project>
Index: modules/pvm/src/main/java/org/jbpm/pvm/internal/script/JuelScriptEngineFactory.java
===================================================================
--- modules/pvm/src/main/java/org/jbpm/pvm/internal/script/JuelScriptEngineFactory.java	(revision 6301)
+++ modules/pvm/src/main/java/org/jbpm/pvm/internal/script/JuelScriptEngineFactory.java	(revision 6302)
@@ -24,7 +24,6 @@
 import javax.script.ScriptEngineFactory;
 import javax.script.ScriptEngine;
 import java.util.List;
-import java.util.ArrayList;
 import java.util.Collections;
 
 /**
@@ -32,156 +31,102 @@
  * 
  * @author Heiko.Braun <heiko.braun@jboss.com>
  */
-public class JuelScriptEngineFactory implements ScriptEngineFactory
-{
+public class JuelScriptEngineFactory implements ScriptEngineFactory {
 
-  private static List<String> names = new ArrayList(1);
-  private static List<String> extensions;
-  private static List<String> mimeTypes;
+  private static List<String> names = Collections.singletonList("juel");
+  private static List<String> extensions = names;
+  private static List<String> mimeTypes = Collections.emptyList();
 
-  public JuelScriptEngineFactory()
-  {
-    super();   
-  }
-
-  static
-  {
-    names.add("juel");
-
-    names = Collections.unmodifiableList(names);
-
-    extensions = names;
-
-    mimeTypes = new ArrayList(0);
-
-    mimeTypes = Collections.unmodifiableList(mimeTypes);
-  }
-
-  public String getEngineName()
-  {
+  public String getEngineName() {
     return "juel";
   }
 
-  public String getEngineVersion()
-  {
+  public String getEngineVersion() {
     return de.odysseus.el.ExpressionFactoryImpl.class.getPackage().getImplementationVersion();
   }
 
-  public List<String> getExtensions()
-  {
+  public List<String> getExtensions() {
     return extensions;
   }
 
-  public String getLanguageName()
-  {
+  public String getLanguageName() {
     return "JSP 2.1 EL";
   }
 
-  public String getLanguageVersion()
-  {
+  public String getLanguageVersion() {
     return "2.1";
   }
 
-  public String getMethodCallSyntax(String obj, String m, String[] args)
-  {
+  public String getMethodCallSyntax(String obj, String m, String... args) {
     throw new UnsupportedOperationException("getMethodCallSyntax");
   }
 
-  public List<String> getMimeTypes()
-  {
+  public List<String> getMimeTypes() {
     return mimeTypes;
   }
 
-  public List<String> getNames()
-  {
+  public List<String> getNames() {
     return names;
   }
 
-  public String getOutputStatement(String toDisplay)
-  {
+  public String getOutputStatement(String toDisplay) {
     StringBuilder statement = new StringBuilder();
-
     statement.append("out:print(\"");
 
-    int len = toDisplay.length();
-
-    for (int i = 0; i < len; ++i)
-    {
+    for (int i = 0, len = toDisplay.length(); i < len; ++i) {
       char ch = toDisplay.charAt(i);
-
-      switch (ch)
-      {
-        case '"':
-          statement.append("\\\"");
-
-          break;
-        case '\\':
-          statement.append("\\\\");
-
-          break;
-        default:
-          statement.append(ch);
+      switch (ch) {
+      case '"':
+        statement.append("\\\"");
+        break;
+      case '\\':
+        statement.append("\\\\");
+        break;
+      default:
+        statement.append(ch);
       }
-
     }
 
-    statement.append("\")");
-
-    return statement.toString();
+    return statement.append("\")").toString();
   }
 
-  public String getParameter(String key)
-  {
-    if (key.equals("javax.script.name"))
-    {
+  public String getParameter(String key) {
+    if (key.equals("javax.script.name")) {
       return getLanguageName();
     }
-    if (key.equals("javax.script.engine"))
-    {
+    if (key.equals("javax.script.engine")) {
       return getEngineName();
     }
-    if (key.equals("javax.script.engine_version"))
-    {
+    if (key.equals("javax.script.engine_version")) {
       return getEngineVersion();
     }
-    if (key.equals("javax.script.language"))
-    {
+    if (key.equals("javax.script.language")) {
       return getLanguageName();
     }
-    if (key.equals("javax.script.language_version"))
-    {
+    if (key.equals("javax.script.language_version")) {
       return getLanguageVersion();
     }
-    if (key.equals("THREADING"))
-    {
+    if (key.equals("THREADING")) {
       return "MULTITHREADED";
     }
 
     return null;
   }
 
-  public String getProgram(String[] statements)
-  {
+  public String getProgram(String... statements) {
     StringBuilder program = new StringBuilder();
 
-    if (statements.length != 0)
-    {
-      for (int i = 0; i < statements.length; ++i)
-      {
+    if (statements.length != 0) {
+      for (int i = 0; i < statements.length; ++i) {
         program.append("${");
-
         program.append(statements[i]);
-
         program.append("} ");
       }
-
     }
-
     return program.toString();
   }
 
-  public ScriptEngine getScriptEngine()
-  {
+  public ScriptEngine getScriptEngine() {
     return new JuelScriptEngine(this);
   }
 }
Index: modules/distro/src/main/files/install/src/jboss/datasources/jbpm-hsqldb-ds.xml
===================================================================
--- modules/distro/src/main/files/install/src/jboss/datasources/jbpm-hsqldb-ds.xml	(revision 6301)
+++ modules/distro/src/main/files/install/src/jboss/datasources/jbpm-hsqldb-ds.xml	(revision 6302)
@@ -4,10 +4,10 @@
   <local-tx-datasource>
     <jndi-name>JbpmDS</jndi-name>
 
-    <connection-url>jdbc:hsqldb:hsql://localhost:1701</connection-url>    
+    <connection-url>@jdbc.url@</connection-url>    
     <driver-class>org.hsqldb.jdbcDriver</driver-class>
-    <user-name>sa</user-name>
-    <password></password>
+    <user-name>@jdbc.username@</user-name>
+    <password>@jdbc.password@</password>
 
     <!-- connection pool parameters -->
     <min-pool-size>1</min-pool-size>
Index: modules/distro/src/main/files/install/build.xml
===================================================================
--- modules/distro/src/main/files/install/build.xml	(revision 6301)
+++ modules/distro/src/main/files/install/build.xml	(revision 6302)
@@ -321,6 +321,9 @@
         <include name="jbpm-${database}-ds.xml" />
       </fileset>
     </copy>
+    <replace file="${jboss.server.config.dir}/deploy/jbpm/jbpm-${database}-ds.xml"
+             token="$${hsql.bind.address}"
+             value="${hsql.bind.address}" />
 
     <!-- unzip console.war -->
     <mkdir dir="${jboss.server.config.dir}/deploy/jbpm/gwt-console-jbpm.war" />
@@ -420,9 +423,11 @@
       <arg value="-b" />
       <arg value="${jboss.bind.address}" />
     </exec>
-    <waitfor maxwait="5" maxwaitunit="minute" checkevery="30" checkeveryunit="second">
+    <waitfor maxwait="5" maxwaitunit="minute" checkevery="30" checkeveryunit="second"
+      timeoutproperty="jboss.timeout">
       <socket server="${jboss.bind.address}" port="8080" />
     </waitfor>
+    <fail if="jboss.timeout" message="jboss did not start within 5 minutes"/>
   </target>
 
   <!-- ### STOP JBOSS ################################################### -->
@@ -623,9 +628,11 @@
       <arg value="-dbname.0" />
       <arg value="jbpmDatabase" />
     </java>
-    <waitfor maxwait="1" maxwaitunit="minute" checkevery="10" checkeveryunit="second">
+    <waitfor maxwait="1" maxwaitunit="minute" checkevery="10" checkeveryunit="second"
+      timeoutproperty="hsqldb.timeout">
       <socket server="${hsql.bind.address}" port="1701" />
     </waitfor>
+    <fail if="hsqldb.timeout" message="hsqldb server did not start within one minute" />
   </target>
 
   <!-- ### SHUTDOWN HSQLDB SERVER ################################################ -->
